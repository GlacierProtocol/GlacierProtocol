#!/bin/bash
set -e

# Test withdrawing from transactions that were created by SegWit wallets.
# I have four transactions to try:
# 1. Electrum p2wpkh-in-p2sh with change
# 2. Electrum native p2wpkh with change
# 3. Electrum p2wpkh-in-p2sh with no change
# 4. Electrum native p2wpkh with no change


../../glacierscript.py --testnet create-withdrawal-data << INPUT
y
y
y
y
y
y
2NAVkgszAvjZZwWpHpbCaxSaNqCCXPD8Bts
522103d14ddcfb6817f5579695bbb3eb3e185887bf2942b031e6f716343b8fe7e9e8e221028fcd46f8614b2cbf318096968242a1e22bcfb6d8f2b6dc939c8c27c347b2937b210315acb550120f4cdcb460d5c49080ab508ca4ccd8dedecac22feeac8cd017d4c121022b063ee2f22f9e1982c140fe778672c683111a796dcccdbd47bb65e3d608a98354ae
2N5PvoFj6adLPcqHAD24MxEZxvdQMGBLXow
4
010000000001010a7c434b74b3c7e14622df42f58675f4d07f364ebce970173dc0d0554a05e9bf0000000017160014bf7ad0d7943835c572cac751ea5b0dc27705c09bfeffffff02107e88020000000017a9147df2fdfa9e50c7a60598be98133423dc38c2b94987a07f88020000000017a914bd3996bb9a6c401da7e65d4dbb3a9b978cd045ec8702473044022024edd6cc36c22f4cf8596356b68626f996138ade3bb46f2abf7d36d720d1259c022002eecddfbd956fff8fc24263a823d665d085ae7f6402400f31e5042624786ef8012102c9218b76d1e6cc2a1a41f91673b1231111193f73f53f386bff83388c6d72106b473b1300
010000000001010a7c434b74b3c7e14622df42f58675f4d07f364ebce970173dc0d0554a05e9bf0100000000feffffff02084b87020000000017a914bd3996bb9a6c401da7e65d4dbb3a9b978cd045ec8770b38902000000001600142cc6ea9ff95d8f4ce870e184cc0c2f13eb85f94b024730440220519ddc39c2dae10381c8af6b04d7792f59623faa70b417ad05caf453677bc23c022012674cfcd0b3abace75b81616618469e3d36b57ea27f98dd1e98a2fa28fb67440121030bfbc9851ef5171e69e0143e666302664991300fbe45845bfda47a5b1e8b86e7473b1300
0100000000010148121218e5e85b910bdfb12be923b84e5bd1b7bda6dfdf188762b415695cc97500000000171600145022b0830980bffb1598133e6cf2b75445fb5d02feffffff01887d88020000000017a914bd3996bb9a6c401da7e65d4dbb3a9b978cd045ec870247304402207d33e3f8593474ad7e7325b02d0aa5205deb843adcacf67b47fc71efdf62099a02203c625c19e8a36cf3318e3db3213e27921fbdb4e7fe601eff44914241ab79b065012102870f54c757c193cf01d875fa6b3210d8562485f2a38b8a52f63c5df363cd1b9b473b1300
01000000000101df1e32efe8b3222707f4d796fcf2a282195642a1e9da8fd0e510113acc97cc920100000000feffffff01ffb289020000000017a914bd3996bb9a6c401da7e65d4dbb3a9b978cd045ec8702483045022100fc464f9ef35ff0b2abd5f47072a42a0e903df2f54e8c3f3cc840f80fa42bbebb022004ee322a0ea203600a23c3649df490e56bbdb4aa8c2e64a6e240dfd46a2782f401210368768d034ee61659f4b926824793ab3c3668dee8b57a344cb1aefa19bd793510473b1300
2
cQCrT9Ncs9729ao7jbmAWrD9z7tF64s2yKzmD6nkiLAi9sXVZWAn
cP65UeSDZPiTLB6CBwasWv9oJYEjRgQXhswfwcT9HscEKDcEbgy4
1
y

y
INPUT


# Cleanup cruft
rm transaction.png
